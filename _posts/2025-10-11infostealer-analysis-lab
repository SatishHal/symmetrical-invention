# From Phish to Ransom: A Practical Analysis of Infostealer-Driven Attacks

**Author:** Satish Halgi
**Date:** August 6, 2025
**Category:** IT / SaaS / Security Operations

---

## Executive Summary

This project demonstrates a practical, entry-level malware analysis and incident response workflow focused on phishing-based infostealer attacks. The objective was to analyze a phishing email and its attachment in a controlled environment, understand the malware behavior, and assess the potential business impact if such an attack occurred in a real enterprise or SaaS environment.

This project is designed to showcase hands-on problem solving, tooling usage, and documentation skills relevant to IT Help Desk, SaaS Support, and Service Desk roles.

---

## Phase 1: Environment Setup & Email Parsing

A dedicated Python virtual environment (`malware_analysis`) was created to safely handle email parsing and file extraction. This ensures isolation from the host system and reflects real-world IT best practices.

### Environment Setup

```bash
python3 -m venv malware_analysis
source malware_analysis/bin/activate
```

Once activated, all analysis was performed inside the virtual environment.

### Email Parsing

A Python script was used to:

* Parse `.eml` phishing email files
* Extract email headers and body content
* Extract attachments
* Generate SHA-256 hashes for extracted files

This automation allows repeatable analysis for future phishing investigations.

---

## Use of AI Assistance (ChatGPT)

This project leveraged **ChatGPT as an assistive tool** to accelerate the initial generation of a Python script for parsing EML files. The generated script was:

* Reviewed line-by-line
* Tested against sample email files
* Corrected where hashing logic produced inaccurate results

The final implementation used the `eml_parser` library’s built-in hashing functionality to ensure accurate SHA-256 hash generation and proper attachment decoding.

This reflects modern IT and SaaS practices where AI-assisted tooling is used responsibly to improve efficiency, while maintaining technical understanding, validation, and accountability.

---

## Phase 2: Malware Analysis

The extracted attachment’s hash was analyzed using publicly available malware analysis platforms.

### VirusTotal Analysis

* The hash returned multiple detections indicating malicious behavior
* No definitive malware family classification was provided

### Tria.ge Analysis

Further analysis using Tria.ge confirmed the malware as **AgentTesla**, a known information-stealing malware commonly distributed via phishing campaigns.

AgentTesla is capable of:

* Stealing credentials
* Collecting browser and system data
* Exfiltrating information to attacker-controlled infrastructure

---

## Why This Matters (Business Impact)

AgentTesla infections often serve as an initial access vector. Analysis revealed that stolen data could be exfiltrated via SMTP to attacker-controlled email accounts.

This type of compromised data is frequently sold to ransomware-as-a-service (RaaS) groups, transforming a simple phishing email into a full-scale ransomware incident.

Such attacks can lead to:

* Credential compromise
* Lateral movement within networks
* Data exfiltration
* Ransomware deployment
* Operational and reputational damage

---

## Incident Response Recommendations

### If the Attachment Was Executed

* Immediately isolate the affected device
* Disable the user account and reset credentials
* Reimage the system before reconnecting to the network
* Perform threat hunting for related indicators (C2 or SMTP connections)
* Provide targeted phishing awareness training

### If the Attachment Was Not Opened

* Review network and endpoint logs for suspicious activity
* Perform a precautionary security scan
* Educate the user in a non-punitive manner to reinforce security hygiene

---

## Skills Demonstrated

* Phishing analysis fundamentals
* Safe environment setup (Python virtual environments)
* SaaS and endpoint security awareness
* Incident response thinking
* Documentation and communication
* Responsible use of AI-assisted tooling

---

## Disclaimer

All analysis was conducted in a controlled, educational environment using non-production systems. No live malware was executed on production devices.

---

*This project is intended to demonstrate applied IT and SaaS support skills rather than advanced malware research.*
